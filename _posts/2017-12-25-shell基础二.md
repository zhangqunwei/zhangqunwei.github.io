---
layout: post
title: shell基础二
date: 2017-12-25
tags: 脚本
---

### 输入输出重定向
* 标准输入输出

| 设备      | 设备文件名          | 文件描述符      | 类型             |
| :-:      | :-:                | :-:            | :-:              |     
| 键盘      | /dev/stdin         | 0              | 标准输入         |  
| 显示器    | /dev/stdout        | 1              | 标准输出         |
| 显示器    | /dev/stderr        | 2              | 标准错误输出      |     


* 输出重定向  
    理解：将原本输出到屏幕上的内容改变输出方向，将其输出到文件中  

| 类型                     | 符号                 | 作用                                                     |      
| :-:                       | :-:                  | :-:                                                     |  
|标准输出重定向             | 命令 > 文件            | 以覆盖的方式，把命令的正确输出输出到指定的文件或设备中        |    
|标准输出重定向             | 命令 >> 文件            | 以追加的方式，把命令的正确输出输出到指定的文件或设备中        |   
|标准错误输出重定向         | 命令 2> 文件            | 以覆盖的方式，把命令的错误输出输出到指定的文件或设备中        | 
|标准错误输出重定向         | 命令 2>> 文件           | 以追加的方式，把命令的错误输出输出到指定的文件或设备中        |
                                                         
注:以上将错误输出和正确输出分开保存的方法在实际工作中用处不大，以下为常用的方法

| 符号                    | 作用                                                     |    
| :-:                     | :-:                                                       |
| 命令 > 文件2 > &1       |  以覆盖的方式，把正确输出和错误输出都保存到同一个文件中       |
| 命令 >> 文件2 > &1      |  以追加的方式，把正确输出和错误输出都保存到同一个文件         |
| 命令 &> 文件            |  以覆盖的方式，把正确输出和错误输出都保存到同一个文件         |
| 命令 &>> 文件           |  以追加的方式，把正确输出和错误输出都保存到同一个文件         |
| 命令 >> 文件1 2>> 文件2  |  把正确的输出追加到文件1中，把错误的输出追加到文件2中        |

注: `/dev/null`是linux中一个特殊文件。
    一个习惯用法：`ls &>/dev/null`将输出丢到null中，null类似于垃圾箱，黑洞，当我们对输出内容并不感兴趣而只关注命令的执行时可以用此命令                   
  
* 输入重定向  
    理解：将原本从键盘获取的标准输入改变方向，转而将文件中的内容作为标准输入  
    格式：wc [选项] [文件名]
    选项：   
    -c　　　统计字节数  
    -w　　　统计单词数 （以空格作为一个单词的结束标志）  
    -l　　　统计行数（此处是小写的L）　   　  


### 多命令顺序执行

|多命令执行符        |格式                       | 作用|
|:-:                | :-:                       | :-: |
|;                  | 命令1;命令2                | 多个命令顺序执行，命令之间没有任何逻辑联系  |     
|&&                 | 命令1&&命令2               | 逻辑与:当命令1正确执行，则命令2才会执行,当命令1执行不正确，则命令2不会执行|
|\| \|              | 命令1 \|\| 命令2           | 逻辑或:当命令1执行不正确，则命令2才会执行,当命令1正确执行，则命令2不会执行|

* 数据复制   
    dd if=输入文件 of=输出文件 bs=字节数 count=个数   
    选项：  
        if =输入文件　　　　指定源文件或源设备    
        of=输出文件　　　　指定目标文件或目标设备    
        bs=字节数　　　　　指定一次输入/输出多少字节，即把这些字节看作一个数据块  　　  
        count=个数　　　　指定输入/输出多少个数据块 　　　   
    例如：   
    date;dd if=/dev/zero of=/root/testfile bs=1k count=100000;date

注：dd命令是linux当中进行磁盘复制或者数据复制的命令，但它不是cp，cp命令
只能复制文件，但是dd命令能复制特殊文件，也能复制分区甚至整个硬盘，它不仅
复制了数据，还复制了文件系统，dd主要用它来进行磁盘复制

* 管道符  
    命令格式： 命令1 |命令2     
    注意：命令1的正确输出作为命令2的操作对象（只有命令1正确输出时才执行命令2）     

### 通配符和其他特殊符号
* 通配符      

| 通配符       | 作用   |
|:-:          | :-: | 
| ?           | 匹配一个任意字符   | 
| *           | 匹配0个或任意多个任意字符，也就是匹配任何内容    |
| []          | 匹配括号中任意一个字符，例如[abc] 匹配a或b或c中的任意一个    |
| [ - ]       | -代表范围，例如[a-d]匹配a到b之间的任意一个字符    |
| [^]         | 逻辑非，表示匹配不是括号内的一个字符。例如[^0-9]代表匹配一个不是数字的字符|    
                
例： 
```bash
# cd /tmp/   
# ls -a   
# rm -rf *   
# touch abc   
# touch abcd   
# touch 012   
# touch 0abc   
# ls ?abc   
# ls [0-9]*   
# ls [^0-9]*   
```
* bash中其他特殊符号   

| 符号    | 作用 |
| :-:      | :-: |
| ''     | 单引号，在单引号中所有特殊符号，如$和 ` (反引号)都没有特殊意义  |
| ""     | 双引号，在双引号中特殊符号都没有特殊含义，但是$和 ` 和 \ 是类外拥有调用变量的值，引    用命令，和转义字符的特殊含义 |
| ``     | 反引号，反引号括起来的内容是系统命令，在bash中会先执行它，和$()作用一样，不过推荐使    用$()，因为反引号非常容易看错|
| $()    | 和反引号作用一样，用来引用系统命令|
| #      | 在shell脚本中，# 开头的行代表注释|
| $      | 用于调用变量的值，如需要调用变量neme的值时，用$name|
| \      | 转义符，跟在\之后的特殊符号将失去特殊含义，变为普通字符.如\$将输出$符号，而不当做是变量引用|
        
注：
1. 反引号是esc下面那个键   
2. 反引号与$()   
    echo \`ls\`  
    echo $(date)  
3. 单引号与双引号  
    name=se  
    echo '$name'  
    echo "$name"  
    echo '$(date)'  
    echo "$(date)"  
4. 通配符是用来匹配文件名的  
